Traffic-driven SIR epidemic model on networks
Cunlai Pu, Siyuan Li, Jian Yang
We propose a novel SIR epidemic model which is driven by the transmission of infection packets in networks. Specifically, infected nodes generate and deliver infection packets causing the spread of the epidemic, while recovered nodes block the delivery of infection packets, and this inhibits the epidemic spreading. The efficient routing protocol governed by a control parameter á is used in the packet transmission. We obtain the maximum instantaneous population of infected nodes, the maximum population of ever infected nodes, as well as the corresponding optimal á through simulation. We find that generally more balanced load distribution leads to more intense and wide spread of an epidemic in networks. Increasing either average node degree or homogeneity of degree distribution will facilitate epidemic spreading. When packet generation rate ñ is small, increasing ñ favors epidemic spreading. However, when ñ is large enough, traffic congestion appears which inhibits epidemic spreading.
As the increase of connectivity in and between different complex systems, spread of many diseases or viruses is becoming more and more prevalent in our society [1, 2, 3, 4] . For instance, outbreaks of many infectious diseases, including Severe Acute Respiratory Syndromes (SARS), Swine flu (H1N1), and the recent Ebola virus, caused great damage and loss of life. The spread of computer and mobile phone viruses brought about a great deal trouble to human life and serious damage to economy. Understanding the intrinsic mechanisms of those spreading processes and designing efficient control strategies become very important and urgent tasks, which bring together a lot of researchers from areas of biology, sociology, mathematics, physics, engineering, etc [3] . Mathematical modeling of epidemic spreading has a long history of more than two hundred years [4] . Generally, the population is divided into several classes: susceptible, infected and recovered individuals. Susceptible individuals represent those who can contract the infection. Infected individuals were previously susceptible individuals and got infected by the disease. Recovered individuals are those who have recovered from the infection. In the susceptible-infected-susceptible (SIS) model [4] , infected individuals can recover from the disease and become susceptible individuals again. While in the susceptible-infected-recovered (SIR) model [4] , infected individuals no longer get infected after recovery from the disease, which are assumed to get the permanent immunity. In classical epidemiology, a common assumption is that individuals in a class is treated similarly, and have equal probability to contact with everyone else [3, 4] . However, the recent abundance of data demonstrates that both the connectivity pattern and the contact rate are heterogeneous among real-world complex networks [3, 5] , which means the traditional deterministic differential equations and many other related results of epidemic processes are inadequate in real-world situations. This great stimulates the research of epidemics on real-world complex networks [4] . Due to the complexity of real-world networks, the mean-field approach [6, 7, 8] and the generating function approach [9] are used to drive the analytic results of epidemics spreading. One of the remarkable results obtained by Pastor-Satorras and Vespignani [4, 6] shows that in the limit of a network of infinite size, the epidemic threshold of the SIS model tends to zero asymptotically in scale-free networks with power-law parameter in (2, 3] . For SIR model, it was found that in the thermodynamic limit, not only the threshold tends to vanish, but also the time for the stabilization of the infection becomes very small [10, 11] . By using the message-passing approach, Karrer and Newman [12] calculated the probabilities for any node and any time to be in state S, I, and R on tree structure. Many other explicit results of SIR model are obtained by mapping the SIR model to the percolation process [9, 13, 14] . Also, effects of degree correlations [15, 16] , clustering [17, 18] , weights and directions of edges [7, 19, 20] on epidemic spreading are broadly discussed. On the other hand, various efficient immunization protocols [4, 21, 22] have been designed for controlling the spread of epidemics on networks. Recently much attention has been transferred to epidemic spreading in temporal and multiplex networks [23, 24, 25] . Addition to diseases or viruses, there are usually many other substances spreading in networks like information packets, goods, ideas, etc., which depend on the specific types of the networks. Epidemic spreading is often coupled with the delivery of these substances. For example, HIV spreads through the exchange of body fluids among individuals in contact networks. Computer viruses spread with the delivery of information packets in computer networks. Flu often spreads by air traffics among different spatial areas. Therefore, understanding the mechanisms of these coupled spreading processes and how these processes affect each other is significant for designing efficient epidemic immunization strategies. Meloni et al [26] first studied the effects of traffic flow on epidemic spreading. They found that the epidemic threshold in the SIS model decreases as flow increases, and emergence of traffic congestion slows down the spread of epidemics. Then, Yang et al [27, 28] further studied the relation between traffic dynamics and the SIS epidemic model, and found that the epidemic can be controlled by fine tuning the local or global routing schemes. Furthermore, they obtained that the epidemic threshold can be enhanced by cutting some specific edges in the network [29] . The impacts of traffic dynamics on SIR epidemic model haven't been reported in literature. In this paper, we study the traffic-driven SIR spreading dynamics in complex networks. We focus on the instantaneous size of infected population, and the final size of ever infected population. Based on these two properties, we study how the packets transmission process governed by given routing protocols affects the epidemic spreading. Our model includes two coupled processes: packet delivery process and the epidemic spreading process. We will introduce our model in the context of computer networks. We assume that nodes in the network are identical which can generate, receive and deliver information packets. Each node has a queue obeying the First-In-First-Out (FIFO) rule for storing packets. The length of the queue is set infinite. Load of a node is the number of packets in its queue. Every node generates packets at a rate ñ. For example if ñ = 1.5, each time an arbitrary node generates one packet definitely and another one with probability 0.5. The destination nodes of the packets are chosen randomly, and the packets will be removed from the network after arriving at the destination nodes. The transmission of packets is governed by the efficient routing protocol proposed by Yan et al [30] . For an arbitrary path p of length l between node s and d, denoted as s, n 1 , n 2 , · · · , n l?1 , d , its routing cost is defined as follows: Where k i is the degree of node i, and á is a control parameter. The sum runs over all the intermediate nodes of path p. The efficient paths for delivering packets are defined to be those which have the minimum routing costs. If there are many efficient paths between two nodes, we randomly chose one for delivering packets. According to Eq. 1, á determines the routing cost of a path. When á > 0, paths with large-degree nodes usually have large routing costs. Thus, efficient paths tend to be those paths composed of small-degree nodes when á > 0, and vice versa. Each time a node can deliver at most C packets. When C = ?, all the packets can be delivered without delay, there is no traffic congestion. The overall load of the network is constant after a short transient time. When C is a constant value, there is a critical packet generation rate ñ c . When ñ < ñ c , there is no traffic congestion. When ñ > ñ c , the network generates more packets than it can deliver. As a result, the overall load of the network increases with time, which is the traffic congestion phenomenon. We use the order parameter to characterize the traffic congestion, which is as follows [31] : Where w(t) is the total number of packets in the network at time t. When ø = 0, the generated and delivered packets are balanced, and the network is under the free flow state. When ø > 0, packets accumulate continuously in the network, which indicates that there exists traffic congestion. As in the traditional SIR model, nodes in the network are divided into three classes: susceptible nodes, infected nodes and recovered nodes. Initially, all the nodes in the network are susceptible nodes, which perform the normal function of generating, delivering, and receiving packets, and the network flow is stable. Then we randomly select a node to be an infected one which is the original source of the infection. Infected nodes generate infection packets instead of normal packets at each time step. With the delivery of these infection packets, more and more susceptible nodes get infected after receiving the infection packets. Infected nodes get recovered and become recovered nodes with probability µ at each time step. Recovered nodes generate normal packets, and they can also make the infection packets into normal packets. Thus, recovered nodes block the epidemic spreading. The epidemic spreading ends when all the infected nodes become recovered nodes. The transitions between the susceptible, infected, and recovered nodes for our model are shown in figure 1. The underlying networks are random networks generated by the Erd?s-R?nyi (ER) model [32] and scale-free networks generated by the static model [33] . Also, some realworld networks [34, 35, 36] are used in the simulations.  We assume that, at time t, the numbers of susceptible nodes, infected nodes and recovered nodes are S(t), I(t) and R(t) respectively. First, we study the time evolution of our model on the ER model, the static model, and the Email network [34] . We add the infection to the network at t = 150 when the network is under free flow state, by randomly selecting a node to become infected. In figure 2 (a), (b) and (c), we see that S(t) decreases with t greatly, and then tends to be stable. On the contrary, R(t) increases with t abruptly, and then converges at R e , which is the maximum number of recovered (or ever infected) node. R e reflects the range of the infection. Differently from S(t) and R(t), I(t) increases with t first, then decreases with t. The peak of I(t), denoted by I p , represents the maximum instantaneous number of infected nodes during the epidemic spreading process. I p reflects how intense the epidemic spreading is. At any time t, the sum of S(t), I(t), and R(t) equals the size of the network. Routing parameter á is one of the important factors in our model. á determines the efficient paths for the delivery of normal and infection packets. In figure 2(d) , (e), and (f), we see that S(t), I(t) and R(t) all vary with á, and for any of the three, the trends of the curves of different á are similar. We focus on the maximum instantaneous size of infected population I p , and the final size of ever infected population R e . In figure 3 (a), (b) and (c), we see that both I p and R e increase with á first, then decrease with á. There are optimal á which correspond to the maximum I p and R e respectively. Note that the optimal á for I p and R e are close, but not necessarily the same. There are jumps in both I p and R e when á is near zero. To explain these results, we calculate the load variance ó L of nodes, which is defined as follows: Where L i (t) is the load of node i at time t. T is a constant value and is large enough to ensure accurate calculation of the average load L i of node i. When ó L is small, the load distribution is relatively even in the network, and vice versa. In figure 3 (d) , (e) and (f), ó L decreases first and then increases with á. There is optimal á which leads to the minimum ó L . Interestingly, the values of the optimal á for ó L , I p and R e are close, which indicates that homogeneous load distribution facilitates the epidemic spreading. There is also abrupt decrease in ó L when á is near zero. This is because the efficient paths are very different for á < 0 and á > 0, and the load is abruptly redistributed from large-degree nodes to small-degree nodes when á increases from below zero to above zero. This also accounts for the jumps in I p and R e . The results are consistent for both the models networks and the Email network as shown in figure 3.  Packet generation rate ñ also has great impacts on the epidemic spreading. In figure 4 , we see that the peak of R e for ñ = 0.5 is almost 4 times of the peak of R e for ñ = 0.2. The peak of I p for ñ = 0.5 is almost 6 times of the peak of I p for ñ = 0.2. Also the positions of the peaks for ñ = 0.1, 0.2 and 0.5 are different. In figure 5 (a), we clearly see both the maximum I p and the maximum R e increase with ñ. When ñ becomes large, infected nodes will generate more infected packets, which facilitates the epidemic spreading. In figure 5 (b) , we see that á opt decreases with ñ, which indicates an increase of dependency on large-degree nodes. To illustrate this, we focus on the top 1% largest degree nodes, and calculate the average ratio ç of the number of infection packets a large degree node delivered when it was infected to the number of infection packets it cured after it recovered. In figure 6 , ç increases with ñ, which means that the role large-degree nodes play in facilitating the epidemic spreading becomes more and more remarkable compared to the role they play in inhibiting the epidemic spreading. This explains why the epidemic spreading becomes more dependent on large-degree nodes to spread widely when ñ increases as shown in figure 5 (b) . First, we show the impacts of network density on the epidemic spreading. In figure 7 (a) and (c), we see that the maximum I p and the maximum R e increase with average degree k for both random networks and scale-free networks. This indicates that more edges facilitate the epidemic spreading. In figure 7 (b) and (d), á opt decreases with k , but is large than zero. This means that, to realize an intense and wide epidemic spreading, generally the paths for the delivery of infection packets should be biased towards including small-degree nodes, but when the network becomes dense, the degree of the dependence of large-degree nodes in the transmission of infection packets should be increased accordingly. Then we show the impacts of power-law parameter ã on the epidemic spreading in figure 8 . Both the maximum I p and the maximum R e increase with ã first, and then tend to be stable. The á opt increases slightly with ã. We infer from figure 8 that homogeneous network structure facilitates the epidemic spreading. When delivery capacity C is a constant value, and the packet generation rate ñ is large enough, the packets can't be delivered in time, and then the number of packets accumulated in the network increases with time, which is the traffic congestion phenomenon. In the simulation, C is set to 10, ø is calculated according to Eq. 2 to quantify the degree of traffic congestion. In figure 9 (a), we see that only when á is in [0. 6, 1] , there is no traffic congestion in the network, which is indicated by ø = 0. Otherwise, there exists traffic congestion where ø > 0. In figure 9 (b), we see that both I p and R e increase with á first, and then decrease with á. The optimal á for I p and R e Figure 7 . The maximum I p , the maximum R e and the corresponding á opt vs. k . The results are the average over 100 independent runs. are 0.7 and 0.9 respectively, where there is no traffic congestion. Also, we obtain that when the traffic congestion is not serious like á in [1.5, 2] (figure 9 (a)), the epidemic spreading can still spread intensely and widely, which is inferred by I p and R e in figure  9 (b). Then we fix á to be zero, and study how the maximum I p and the maximum R e vary with ñ. In figure 10 , we obtain that both the maximum I p and the maximum R e increase first and then decrease with ñ, which is consistent for both random networks and scale-free networks. The reason for these results is that when ñ is small, there is no traffic congestion, and the infection becomes intense and wide spread with increase of ñ. However, when ñ is large enough, traffic congestion appears, which inhibits the epidemic spreading.  In addition to the efficient routing protocol, we also study the impacts of the other static routing protocols on the epidemic spreading. If k is replaced with lg k in Eq. 1, then we get the cost function of the optimal routing protocol [37] . For the optimal routing protocol, we only present the results of I p and R e vs. á on three real-world networks [34, 35, 36] in figure 11 . There are also optimal á which correspond to the maximum I p and the maximum R e respectively. When á is near zero, there are also jumps in I p and R e due to the significant change of paths for delivering packets. For the optimal routing and the efficient routing, either the maximum I p or the maximum R e is very close. The difference lies in that I p and R e of the optimal routing vary much slower than that of the efficient routing. In summary, we propose a traffic-driven SIR epidemic model and study the impacts of several factors on our model. We find that the epidemic spreading is greatly affected by the load distribution, and homogeneous load distribution facilitates the epidemic Figure 11 . I p and R e vs. á for the optimal routing and the efficient routing on three real-world networks. The results are the average over 100 independent runs. spreading. Increasing the network density or network homogeneity will enhance the epidemic spreading. Large-degree nodes have dual effects on the epidemic spreading, since large-degree infected nodes facilitate the epidemic spreading, while large-degree recovered nodes greatly inhibit the epidemic spreading. To realize an intense and wide epidemic spreading, the paths for the delivery of packets are generally biased towards including small-degree nodes. Increasing packet generation rate generally favors the epidemic spreading. However, when the amount of generated packets is larger than the delivery capacity of the network, there will exit traffic congestion, which blocks the epidemic spreading. Also, we find similar impacts of different static routing protocols on the traffic-driven SIR epidemic spreading. Our work helps understanding the interplay between traffic dynamics and epidemic spreading, and provides some clues for network immunization. 