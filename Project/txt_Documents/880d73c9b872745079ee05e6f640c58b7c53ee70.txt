At-risk-measure Sampling in Case-Control Studies with Aggregated Data
Michael Garber, Lauren Mccullough, Stephen Mooney, Michael Kramer, Kari Watkins, R Lobelo, W Flanders
Transient exposures are difficult to measure in epidemiologic studies, especially when both the status of being at risk for an outcome and the exposure change over time and space, as when measuring built-environment risk on transportation injury. Contemporary "big data" generated by mobile sensors can improve measurement of transient exposures. Exposure information generated by these devices typically only samples the experience of the target cohort, so a case-control framework may be useful. However, for anonymity, the data may not be available by individual, precluding a case-crossover approach. We present a method called at-risk-measure sampling. Its goal is to estimate the denominator of an incidence rate ratio (exposed to unexposed measure of the at-risk experience) given an aggregated summary of the at-risk measure from a cohort. Rather than sampling individuals or locations, the method samples the measure of the at-risk experience. Specifically, the method as presented samples person-distance and person-events summarized by location. It is illustrated with data from a mobile app used to record bicycling. The method extends an established case-control sampling principle: sample the at-risk experience of a cohort study such that the sampled exposure distribution approximates that of the cohort. It is distinct from density sampling in that the sample remains in the form of the at-risk measure, which may be continuous, such as person-time or person-distance. This aspect may be both logistically and statistically efficient if such a sample is already available, for example from big-data sources like aggregated mobile-sensor data.
T ransient exposures are difficult to measure in epidemiologic studies, especially when both the status of being at risk for an outcome and the exposure change over time. For example, people are at risk of pedestrian fatality only while walking. During this at-risk period, exposures of interest, such as the presence of a sidewalk, may also vary. For etiologic inference, the transience of both at-risk status and exposure should be considered. Measures that account for this transience include person-time (e.g., hours walked), persondistance (kilometers walked), or person-events (intersections crossed on foot). We refer to these, collectively, as measures of the at-risk experience or at-risk measures. Traditional methods to collect transient exposure measures, such as a survey or a travel log, can be both burdensome and inaccurate. 1 Developments in mobile sensing can make data collection less onerous and more accurate. 2 For example, global positioning system (GPS) measurements from mobile devices can be used to reconstruct a study participant's travel routes, from which time or distance exposed to certain environmental conditions at that place and time can be measured. [3] [4] [5] Such exposures might include transportation infrastructure, 6 air pollution, 3, 7, 8 liquor stores, 9 or areas of malaria risk. 10 In principle, researchers could request that individuals download and share their location history, which is passively tracked by common smartphones. 11, 12 However, recruiting willing individuals may be impractical. 13 To avoid individual recruitment, researchers might use existing sources of anonymized mobile-sensor-generated data with activity summarized by location rather than by person. Strava, for example, aggregates its users' bicycling data by street segment. 7, 14, 15 Using this information, the total bicyclekilometers ridden in an area could then be calculated. Whether mobile-sensor data are available by individual or are aggregated, the data will often not be available for the entire target population. Case-control sampling strategies should thus be considered. If data are available by person, a case-crossover design could be used. 16 Use of the case-crossover, however, requires data on an individual's exposure for at least one referent period, 17, 18 precluding the method if the mobile-sensor sample is aggregated without individual-level follow-up. If data are instead summarized by geographical location, 6, 19 case-control sampling could be done with density sampling, 20, 21 wherein entities are sampled with replacement with probability proportional to their total at-risk measure during the follow-up period. The at-risk measure is conventionally person-time at the individual-level, 21 but could also be person-distance summarized by roadway 6 or personevents summarized by intersection. Regardless of the at-risk measure used or the level at which it is summarized, a density sample is tabulated as a discrete frequency. 22 In this article, we argue that if a sample of an at-risk measure is available (e.g., person-distance traveled while cohort members used an app), then applying density sampling to that sample could result in a loss of information. Under plausible assumptions, the sample of the at-risk measure may simply be used as is as the control series. We call this approach at-risk-measure sampling. The method's ultimate goal is to estimate the incidence rate ratio (IRR) that would have been observed in a study of the underlying cohort if the full exposure distribution were known. It is distinct from density sampling in that the sample remains in the form of the at-risk measure, which may be continuous like person-time or person-distance. It could also be discrete as in person-events. It is distinct from case-crossover sampling in that it may be used without individual-level information. We first introduce the concept with a short vignette considering person-time. Second, we describe the method in detail assuming a sample of person-distance aggregated by location is available. Third, we comment on how the method applies to person-events, such as intersection crossings. Fourth, we describe methods to adjust for selection bias. Finally, we apply the method to an example study of the incidence rate of bicycle crashes and include a simulated demonstration informed by the empirical example. The target measure of association is the IRR from a cohort study, IRR Exposed cases Measure of total at risk experience expos = ? e ed Unexposed cases Measure of total at risk experience unex ? p posed Exposed cases Unexposed cases Measure of total at ris = ? k k experience exposed Measure of total at risk experience u ? n nexposed , where the second equality follows by rearranging terms. We assume exposure status of cases at the time of occurrence is known, so, as with density sampling, the specific goal is to estimate the ratio in the denominator: Measure of total at risk experience exposed Measure of tota ? l l at risk experience unexposed ? . To introduce the sampling concept, we consider a hypothetical cohort study in which 300 at-risk person-hours were exposed, and 800 were unexposed. Some in the cohort intermittently used a mobile sensor to report their person-time at risk. If 50% of the person-hours were sampled (by having sensor on) independently of exposure, then, in expectation, the sample would contain 150 exposed person-hours and 400 unexposed person-hours. The ratio of exposed to unexposed person-hours in the sample (150/400 = 0.375) would, apart from random error, equal that of the cohort (300/800 = 0.375). This vignette captures the method's essence: sampling a continuous measure of the at-risk experience such that the exposed-to-unexposed ratio in the sample estimates that of the cohort. We now describe the method assuming a sample of person-distance is available with data summarized by spatially referenced segments. Segments are unique portions of roadways or trails. In applications we consider, they are defined by mapping software like OpenStreetMap as the stretch of roadway or trail between intersections and are about 100 m in length. Distance traveled is often of interest in transportationrelated outcomes. 23, 24 Apps used to track bicycling, 7, 14, 15 to hail rides, 25 or to otherwise monitor movement 26,27 may collect distance traveled by users. To protect user privacy, data may be aggregated before being made available for research. A spatial summary might also be preferred by the research question. The cohort is defined by activity at risk during a time period in a study area, say, a city. People may freely enter and leave the cohort; only their at-risk activity in the study area and timeframe is considered part of the cohort. The goal is to estimate the IRR between a transient exposure and an acute outcome in this cohort. The study area is defined by a set of M segments, m, m , classified by a binary exposure condition, E m = 1 or E m = 0. If exposure varies spatially within segment (e.g., a segment is 60% exposed rather than 100% or 0%), we recommend redefining segments with geographic information systems software so that exposure is constant with segments. The number of times any individual travels along segment m in either direction while at risk for the outcome is denoted by N m , N m = ? 0 1 2 , , , .., . Using the vertical bar to denote "given that," the total person-distance in the cohort in exposure category e is (1) Note: the totals in each exposure category can be equivalently defined as the sum of activity of individual people, assuming the same cohort definition is used (eAppendix 1; http://links.lww.com/EDE/B732). Thus, conclusions drawn from this location-based framework can apply to individuals. Suppose some of the individuals who ever pass through the study area during the timeframe at times use a mobile sensor or smartphone app to record their activity. For anonymity, their activity is summarized by segment before it is made available for research (e.g., https:// metro.strava.com/; accessed 3 January 2020). The number of times a person travels along segment m in the time period while using the sensor, and thus in the sample, is  We now show a condition sufficient for the ratio of exposed to unexposed sampled person-distance, d d 1 0 , to consistently estimate that of the cohort, D . The condition is that the ratio of expected values of exposed to unexposed persondistance in the sample equals that of the cohort: Alternatively phrased by re-arranging terms, the expected person-distance exposed in the sample divided by the expected exposed person-distance in the cohort should equal the corresponding fraction for the unexposed: That  The condition is flexible in that it allows dependence between L m , N m , and f m , as depicted in Figure 1 . As long as associations are such that equation 3 is satisfied, consistency holds. Nevertheless, the condition may benefit from simplification. One possibility, which is partially verifiable, is to consider whether, in each exposure category, segment length L m is independent of both the number of times the segment was traveled upon in the cohort, N m , and in the sample, n m . If so, then equation 4 simplifies to The principles also apply if the at-risk measure were person-events rather than person-distance. Person-events are conceptualized as being countable-discrete occurrences of being at risk for the outcome. For example, Strava counts the number of times intersections were crossed by app-using bicyclists, and Yelp counts the number of times restaurants were visited by app-using diners. 28 The sampling concept is essentially the same, except the length dimension, L m , need not be considered ( Figure 2 ). As detailed in eAppendix 2; http:// links.lww.com/EDE/B732, the condition for consistency is equation 5, above. The condition, equation 3, may often be plausible. For example, if the mobile sensor is always on and does not require user input, then the sampling mechanism may not be associated with exposure. However, the condition will not always hold. Individuals who use mobile sensors requiring manual input may have distinct behavior patterns from non-users In this scenario, f m is positively associated with N m and negatively associated with L m . Nevertheless, the ratio of exposed to unexposed person-distance in the sample is about the same as that in the cohort. R code to produce the figure is here: https://github.com/michaeldgarber/at-risk-measure-sampling/blob/master/code/code-for-figures.md. An illustration of aggregated person-event sampling at intersections. The notation follows that of Figure 1 , except intersections are conceptualized as having no length dimension, reflected by the constant width of the bars. R code to produce the figure is here: https:// github.com/michaeldgarber/at-riskmeasure-sampling/blob/master/ code/code-for-figures.md. Intersection Number of trips over intersection Sampled which differ by exposure. 29 For example, app-using bicyclists may tend to prefer certain infrastructure. 30 To check and correct for selection bias, established principles can be followed. [31] [32] [33] [34] Here, we describe inverseprobability-of-selection weighting (IPSW) with internal validation data. In the supplement (eAppendix 3; http://links. lww.com/EDE/B732), we also consider estimating a summary bias "breaker." 33 IPSW uses a subset of S segments, , , , , , , containing measurement of both N m and the sampled (e.g., app-recorded) version, n m , such that the true sampling fraction, f m , is known among the subset. Such data are commonly available in transportation settings, where the total count of motor vehicles, 35 bicyclists, 15, 36 or pedestrians 37 may be monitored at some locations. The estimated sampling fraction beyond the subset, f m , can then be estimated, possibly with a parametric model. 34 38 If internal validation data are not available and bias parameters cannot be drawn from literature, targeted-adjustment sensitivity analyses may be conducted. 32 To illustrate the method, we estimate the IRR of policereported crashes between bicyclists and motor vehicles per bicycle-kilometer traveled comparing roadway types in Atlanta, GA, for 23 months between 1 October 2016 and 31 July 2018. We classified the roadway type as primary, secondary, tertiary, or residential by the OpenStreetMap definition (https://wiki.openstreetmap.org/wiki/Key:highway#Roads; accessed 19 April 2020). We considered residential roadways unexposed and classified the other three types as exposed. The study area is the set of roadways in either condition in the 8.85-km radius around the intersection of Ponce de Leon Ave NE and Monroe Dr NE (Figure 3) . We obtained a sample of bicyclist-distance in the area and timeframe from Strava. Strava outputs the number of times a bicyclist travels along a segment while using the app. Segments, described above, were defined by Strava using the OpenStreetMap basemap (n, segments = 20,276; Table 1) . Following equation 2, we calculated sampled bicycle-distance on each segment by multiplying the number of times the segment was ridden in Strava by the segment's length ( Figure 3 ; Table 2 ). We obtained geolocated police-reported crashes (n = 129) between bicyclists and drivers of motor vehicles from a state registry. Information on Strava use is not available for the crashes. If a crash occurred at an intersection between exposure types (n = 46; e.g., a primary road intersecting a residential road), we classified the case as occurring on the road from which the bicyclist entered the intersection, as described on the police report. We assume that the cases, bicycle crashes reported specifically by police, are accurately classified and are not under-reported. 40 The study was approved by the Emory University Institutional Review Board (IRB00105514). All or a portion of included data was licensed by Strava. We estimate the IRR in four ways. We first report the estimated bicycle-distance from Strava. We then adjust for possible selection bias using IPSW. Third, although causal inference is not necessarily the explicit goal, we adjust for possible confounding. We finally employ multiple bias analysis. Following equation 2, we report summed bicycledistance from Strava in each exposure category, yielding an estimated IRR of 3.0 [95% confidence interval (CI): 1.4, 5.9; Table 2 ]. If the condition, equation 3, holds, then the observed ratio of exposed to unexposed bicycle-distance of 1.4 (95% CI: 1.1, 1.9) estimates that of the cohort, and the IRR estimates the IRR of the cohort. We checked whether we could simplify the condition per equation 5 but observed a weak association between L m and n m (correlation = -0.09), so we did not simplify. Sampling uncertainty was estimated by hierarchical bootstrapping. Street segments are nested within street, which are also defined by OpenStreetMap. To consider correlation of nested observations, we first resampled streets with any crashes (n = 75) with replacement without weighting. Then, within sampled streets, we resampled segments containing any crashes (n = 115) with replacement, weighted by their number of crashes. Similarly, streets with any bicycle ridership in Strava (n = 2,773) were resampled with replacement without weighting. Then, within sampled streets, segments (n = 20,276) were resampled with replacement weighted by the number of times the segment was ridden. Over 1,000 replications, the 95% CI for each parameter of interest was calculated by the percentile method 41 as the empirical 2.5th and 97.5th percentiles. Second, to check and adjust for selection bias, we used IPSW. Previous research from Atlanta reported that cyclists who used Strava tended to be more confident cyclists, 30 which may mean that they are more likely than non-app users to ride on nonresidential roadways, possibly inducing selection bias. To implement IPSW, with permission of the City of Atlanta, 42 we gathered internal validation data from nine stationary counters (manufacturer: Eco-Counter Urban ZELT) that monitor bicycle traffic in real time with high accuracy 37,43 located at fixed locations throughout the study area. Data from the nine counters were available, on average, in 17.3 of the 23 study months. We calculated the sampling fraction in the 156 segment-month observations. We then fit an events-trials logistic regression model in those observations to estimate the sampling fraction when and where it was unknown (n, segment-month observations = 466,192). Independent variables and model performance are described in eAppendix 4; http:// links.lww.com/EDE/B732. To avoid extreme and implausible values, we truncated 38 the estimated sampling fraction at 0.02 0.5. The total person-distance in each exposure category was then estimated, first summing over month, by equation 6. The resulting estimated exposed-to-unexposed ratio of persondistance was 1.3 (95% CI: 1.1, 1.9; Table 2 ), suggesting, conditional on the validity of the IPSW model, that the unadjusted exposure ratio of 1.4 (95% CI: 1.1, 1.9) was a slight overestimate and the condition, equation 3, was narrowly violated. Contrary to our hypothesis above, the model suggests Stravarecorded rides were relatively more likely to have occurred on Bicycle distance (km): residential roads residential (unexposed) roadways. To estimate uncertainty, we resampled residuals from the sampling-fraction model in each bootstrapped replicate, so the 95% CI reflects uncertainty from both the sampling and the parametric model. Third, although the method may be used to estimate associations whether or not causal inference is the goal, 44 we consider confounding adjustment by standardization. A confounder might be time period or another covariate. We considered an area-level socioeconomic status indicator as a possible confounder (defined in eAppendix 5; http://links.lww.com/ EDE/B732) and standardized results using a weighted geometric mean. A weighted arithmetic mean 45 could also be used. In the context of case-control studies, the weighted geometric mean has the useful property of preserving the symmetry of the cross-product ratio, where Y e denotes the number of crashes in exposure category e, and the wgm subscript denotes the weighted geometric mean. The resulting IRR wgm was 2.4 [95% CI: 1.2, Infinity (Inf)], with the 95% CI again calculated using hierarchical bootstrapping. Finally, we conducted multiple bias analysis by first employing IPSW and then standardization, following advice to adjust for possible biases in the expected reverse order in which they may have manifested. 32 The resulting IRR of 2.6 (95% CI: 1.2, Inf) was slightly higher than when adjusting for confounding alone [IRR = 2.4 (95% CI: 1.2, Inf)] but lower than when adjusting for selection bias alone [IRR = 3.1 (95% CI: 1.4, 6.0); Table 2 ]. In an online repository (https://github.com/michaeldgarber/at-risk-measure-sampling), we have posted accompanying R code. One script presents a simple simulation to illustrate the condition, equation 3. Another follows the above empirical analysis with simulated hierarchical data. We have presented a method called at-risk-measure sampling, the goal of which is to estimate the ratio of the exposed to unexposed measure of the experience at risk in a rate-based cohort study. The concept aligns with established case-control principles 20, 21, 46 : sample the at-risk experience of a cohort study such that the sampled exposure distribution approximates that of the cohort. Its new aspect is that it accommodates sampling a continuous measure of the atrisk experience when aggregated by location. We expect the method to be useful when studying geographically specific exposures and acute outcomes with short induction periods. The method has similarities with case-base sampling, case-crossover sampling, methods estimating individual-level risk from area-level summaries, and incidence density sampling. Depending on the circumstances, at-risk-measure sampling may have practical and conceptual advantages compared with these established methods. The method is related to the case-base design 47 in that the case-base approach may consider time at risk in the control series when calculating the estimated measure of association. 48 Distinct from the casebase approach, which conventionally samples individuals, the proposed approach samples the possibly more general at-risk experience. To our knowledge, the case-crossover 18, 49 and its relatives 50 are the only established methods in the case-control family that have sampled the at-risk experience in continuous No bias adjustment 1.5 ? 10 6 (1.2 ? 10 6 , 1.8 ? 10 6 ) 1.1 ? 10 6 (0.9 ? 10 6 , 1. The 95% CI was estimated by the percentile method using nonparametric hierarchical bootstrapping (N, replications = 1,000). For scenarios including IPSW, the 95% CI also considers the uncertainty due to the parametric sampling-fraction model. Please see text for exposure definition and additional detail. a The pseudo-incidence rate is the number of crashes divided by the sampled person-distance, following the terminology on p. 113 of Modern Epidemiology, 3rd Edition. 21 form as the control series. 18, 51 In example tables in Maclure's seminal paper on the case-crossover, control data are measured in person-hours. 18 At-risk-measure sampling is similar to generalizations of the case-crossover like the case-time-control 50 in that it may sample a continuous measure of the at-risk experience and may include that of non-cases (see Figure 3 by Schneeweiss et al. 17 ). It is distinct from those approaches in that it explicitly accommodates an aggregated summary of the at-risk experience. The example study above might have used a case-crossover, 52 but doing so would have required measurement of exposure in a referent period for each case, information we did not have. The presented method provides another option for estimating epidemiologic measures of association using existing aggregated mobile-sensor data. 14, 25, 26 Other methods have considered settings combining individual-level information about cases with area-level or ecological summaries of the source population at risk. [53] [54] [55] [56] While similar, the proposed method differs from these approaches in that we assume a sample of the at-risk measure is available in each stratum of the exposure. Although particulars vary, the referenced works have considered the situation wherein only an area-level summary of exposure is available, and withinarea variation is not directly accessible. [53] [54] [55] [56] Unmatched incidence density sampling can also be used with data summarized by location. 6, 19 Modifying the definition on p. 124 21 to consider locations, under unmatched locationbased density-sampling, segments are sampled with replacement with probability proportional to the person-distance at risk occurring on them and then, if exposure varies spatially within the sampled segment, a point along each sampled segment is sampled in a second stage to measure exposure. The study by Aldred and colleagues 6 illustrates this approach. In the proposed approach, rather than sampling places with replacement with probability proportional to their at-risk measure, the aggregated at-risk measure is sampled without replacement directly. We see three advantages to this distinction. First, it can be practically advantageous if a sample of an at-risk measure is already available in this format, as in our example. Second, the proposed approach is conceptually appealing in that it reinforces the notion that a case-control study is a sample of a hypothetical cohort study. 21, 46, 57 When the risk ratio is the target parameter, this concept is clear: people are the at-risk measure, and people are sampled. 48, 58 In contrast, when the IRR is the target parameter, a density sample is expected to be proportional to person-time but is not itself a direct sample of person-time, depending on the definition. 21 If instead the IRR is estimated by sampling person-moments from the study base, 22, 59, 60 this concept is perhaps more explicit. 60 The proposed approach might be viewed as extending person-moment sampling 61 to settings with a sample of aggregated, possibly continuous, at-risk data. Third, the proposed approach may be more statistically precise than density sampling. In our example, bicycle-distance was obtained in a single stage (from our perspective) from Strava, and exposure was measured within that sample. Conceivably, we could have applied density sampling to the first-stage sample by sampling segments with replacement with probability proportional to their sampled person-distance. This additional sampling would have lost statistical efficiency without practical benefit. The total sampling variance would have been at least as large as that of the original sample 61 and would have garnered no new information since exposure was known throughout the initial sample. As with location-based density sampling, we imagine the method being most useful for studies of associations between spatially specific measures of exposure and acute outcomes with brief induction periods. Example questions of interest may be associations between roadway infrastructure and crashes in transportation epidemiology, as illustrated above, or associations between environmental factors and violent assault. 62 As the induction period becomes longer and the exposure less spatially specific, the approach may be less informative. For example, anonymized restaurant check-ins have been used to study foodborne illness. 28, 63 Location-level person-event sampling, as described here, could be used to study the IRR between staph infection and exposure to restaurants of concern, but correct specification of the induction period may be a strong assumption. 64, 65 Selection bias may also be a threat to validity. We illustrated IPSW to adjust for possible selection bias. Our IPSW model was limited in that it was fit in only 156 observations and predicted the sampling fraction for 466,192 observations. Although selection bias is possible, an important result is that consistency can hold despite an association between sampling and the at-risk measure (Figure 1 ). This result is reassuring because people who spend more time at risk may more often sample their activity with a sensor. 29, 30  In closing, the at-risk-measure sampling method applies a well-established concept: that a sample of the risk experience from a cohort study can be used to estimate the ratio measure of association. 20, 21, 46, 48 Its new aspect is that it accommodates sampling a continuous measure of the atrisk experience for studies aiming to estimate the IRR with aggregated data summarized by location. Compared with the usual density sampling approach, the sample may sometimes be simpler to obtain, like from existing sources of mobilesensor data. 